

## Instructions

Download and install the modified `GEMF` tool, e.g.:

```bash
git clone https://github.com/nizzaneela/GEMF.git
cd GEMF
make
sudo mv GEMF /usr/local/bin/
cd ..
```

Download and install `CoaTran`, e.g.:

```bash
git clone https://github.com/niemasd/CoaTran.git
cd CoaTran
make
sudo mv coatran_* /usr/local/bin/
cd ..
```

Install `numpy` version 1.19 or later, and [treeswift](https://github.com/niemasd/TreeSwift), e.g.:
```bash
sudo pip install numpy
sudo pip install treeswift
```

Clone this repository and enter the main directory, e.g.:
```bash
git clone https://github.com/nizzaneela/re-multi-introductions.git
cd re-multi-introductions
```

The analysis can then be reproduced with python script `replicate.py`. It takes one argument: the number of processes to run in parallel, e.g.:
```bash
python3 replicate.py 20
```
Each process needs about 3Gb RAM. With 20 processes in parallel, the reproduction takes 8 to 10 days.

The notebook `postprocessing.ipynb` collates the data generated by the rerproduction into the files `main_one_intro_output.tsv` and `main_two_intro_output.tsv`, and generates plots of the likelihoods and Bayes factors.

Results for any particular simulated epidemic or pair of epidemics can be reproduced and compared to the results stored `main_one_intro_output.tsv` and `main_two_intro_output.tsv` with the notebook `verfiy.ipynb`.
